<!-- app/views/dns_lookups/lookup.html.erb -->
<div class="container mt-5">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <h1 class="text-center">DNS Lookup</h1>
      <%= form_with url: dns_lookups_lookup_path, method: :get, local: true, class: 'mt-4' do %>
        <div class="input-group mb-3">
          <%= text_field_tag :domain, params[:domain], class: 'form-control', placeholder: 'Enter a domain name' %>
          <div class="input-group-append">
            <%= submit_tag 'Lookup', class: 'btn btn-primary' %>
          </div>
        </div>
      <% end %>

      <% if @results && @results.any? %>
        <table class="table table-striped table-bordered mt-4">
          <thead class="thead-dark">
            <tr>
              <th>Type</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            <% @results.each do |record_type, records| %>
              <% if records %>
                <% records.answer.each do |record| %>
                  <tr>
                    <td><%= record_type %></td>
                    <td>
                      <% if record_type == Dnsruby::Types.CNAME %>
                        <%= record.name %> <%= record.domainname %>
                      <% else %>
                        <%= record %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              <% end %>
            <% end %>
          </tbody>
        </table>
      <% elsif @results %>
        <div class="alert alert-warning mt-4" role="alert">
          No results found
        </div>
      <% end %>
    </div>
  </div>
</div>
